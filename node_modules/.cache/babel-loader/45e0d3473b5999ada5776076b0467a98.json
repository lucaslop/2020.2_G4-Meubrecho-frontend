{"ast":null,"code":"var _jsxFileName = \"/home/lucaslopes/\\xC1rea de Trabalho/2020.2_G4-Meubrecho-frontend/src/pages/Loja/productsList.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport PropTypes from 'prop-types';\nimport Item from '../../components/item/item';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ListaProdutos({\n  filters,\n  name\n}) {\n  _s();\n\n  const [products, setProducts] = useState(null);\n\n  const getProducts = () => {\n    let token;\n    token = localStorage.getItem('authToken');\n\n    if (products.length === 0) {\n      console.log('teste', products);\n      var myHeaders = new Headers();\n      myHeaders.append('Authorization', `Bearer ${token}`);\n      var myInit = {\n        method: 'GET',\n        headers: myHeaders\n      };\n      const request = new Request('http://localhost:3333/product', myInit);\n      return fetch(request).then(response => {\n        if (response.status == 401) {\n          localStorage.clear();\n          window.location.href = '/register';\n          throw 'permission error';\n        }\n\n        return response.json();\n      }).then(jsonResponse => {\n        console.log('api', jsonResponse);\n        if (jsonResponse.length !== 0) setProducts(jsonResponse);else setProducts({\n          error: 'Sem Protutos na loja'\n        });\n        return products;\n      }).catch(e => {\n        console.log(e);\n      });\n    } else return products;\n  };\n\n  getProducts();\n\n  function onClickFavorite(productId) {\n    console.log('clickId', productId);\n    let token = localStorage.getItem('authToken');\n    let userId = localStorage.getItem('userId');\n    var myHeaders = new Headers();\n    myHeaders.append('Authorization', `Bearer ${token}`);\n    var myInit = {\n      method: 'POST',\n      headers: myHeaders,\n      body: {\n        userId: userId\n      }\n    };\n    const request = new Request(`http://localhost:3333/product/favorite/${productId}`, myInit);\n    fetch(request).then(response => response.json()).then(jsonResponse => {\n      if (jsonResponse.Error !== undefined) alert(jsonResponse.Error);else alert('O produto foi adicionado aos favoritos');\n    });\n  }\n\n  function validateTags(tags) {\n    if (filters.length > 0) for (let filterElement of filters) for (let tagsElement of tags) if (filterElement === tagsElement) {\n      return 1;\n    }\n    if (filters.length == 0) return 1;\n    return 0;\n  }\n\n  const renderProducts = () => {\n    if (products === null) return /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 35\n    }, this);else if (products.error !== null && products.error !== undefined) return /*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        color: 'red'\n      },\n      children: \"A loja n\\xE3o tem nenhum produto no momento\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 14\n    }, this);else {\n      return products.map((product, index) => {\n        if (validateTags(product.tag)) {\n          if (name.length !== 0 && product.nome.includes(name)) return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Item, {\n              productId: product._id,\n              name: product.nome,\n              image: product.imagem,\n              description: product.descricao,\n              price: product.preco,\n              tag: \"\",\n              buttonConfig: {\n                icon: 'add',\n                text: 'Adicionar aos favoritos',\n                onClickFavorite\n              },\n              onClick: id => onClickFavorite(id)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 15\n          }, this);else if (name.length === 0) return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Item, {\n              productId: product._id,\n              name: product.nome,\n              image: product.imagem,\n              description: product.descricao,\n              price: product.preco,\n              tag: \"\",\n              buttonConfig: {\n                icon: 'add',\n                text: 'Adicionar aos favoritos',\n                onClickFavorite\n              },\n              onClick: id => onClickFavorite(id)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this);\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'row',\n      width: '100%',\n      justifyContent: 'center'\n    },\n    children: renderProducts()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ListaProdutos, \"tpOcaRWUT3dr3451uA2+ynz+vIQ=\");\n\n_c = ListaProdutos;\nListaProdutos.propTypes = {\n  filters: PropTypes.array.isRequired,\n  name: PropTypes.string.isRequired\n};\nexport default ListaProdutos;\n\nvar _c;\n\n$RefreshReg$(_c, \"ListaProdutos\");","map":{"version":3,"sources":["/home/lucaslopes/Área de Trabalho/2020.2_G4-Meubrecho-frontend/src/pages/Loja/productsList.js"],"names":["React","useState","CircularProgress","PropTypes","Item","ListaProdutos","filters","name","products","setProducts","getProducts","token","localStorage","getItem","length","console","log","myHeaders","Headers","append","myInit","method","headers","request","Request","fetch","then","response","status","clear","window","location","href","json","jsonResponse","error","catch","e","onClickFavorite","productId","userId","body","Error","undefined","alert","validateTags","tags","filterElement","tagsElement","renderProducts","color","map","product","index","tag","nome","includes","_id","imagem","descricao","preco","icon","text","id","display","flexDirection","width","justifyContent","propTypes","array","isRequired","string"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport PropTypes from 'prop-types';\n\nimport Item from '../../components/item/item';\n\nfunction ListaProdutos({ filters, name }) {\n  const [products, setProducts] = useState(null);\n  const getProducts = () => {\n    let token;\n    token = localStorage.getItem('authToken');\n    if (products.length === 0) {\n      console.log('teste', products);\n      var myHeaders = new Headers();\n      myHeaders.append('Authorization', `Bearer ${token}`);\n\n      var myInit = {\n        method: 'GET',\n        headers: myHeaders\n      };\n      const request = new Request('http://localhost:3333/product', myInit);\n      return fetch(request)\n        .then(response => {\n          if (response.status == 401) {\n            localStorage.clear();\n            window.location.href = '/register';\n            throw 'permission error';\n          }\n          return response.json();\n        })\n        .then(jsonResponse => {\n          console.log('api', jsonResponse);\n          if (jsonResponse.length !== 0) setProducts(jsonResponse);\n          else setProducts({ error: 'Sem Protutos na loja' });\n          return products;\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    } else return products;\n  };\n\n  getProducts();\n\n  function onClickFavorite(productId) {\n    console.log('clickId', productId);\n    let token = localStorage.getItem('authToken');\n    let userId = localStorage.getItem('userId');\n    var myHeaders = new Headers();\n    myHeaders.append('Authorization', `Bearer ${token}`);\n\n    var myInit = {\n      method: 'POST',\n      headers: myHeaders,\n      body: {\n        userId: userId\n      }\n    };\n    const request = new Request(`http://localhost:3333/product/favorite/${productId}`, myInit);\n    fetch(request)\n      .then(response => response.json())\n      .then(jsonResponse => {\n        if (jsonResponse.Error !== undefined) alert(jsonResponse.Error);\n        else alert('O produto foi adicionado aos favoritos');\n      });\n  }\n  function validateTags(tags) {\n    if (filters.length > 0)\n      for (let filterElement of filters)\n        for (let tagsElement of tags)\n          if (filterElement === tagsElement) {\n            return 1;\n          }\n    if (filters.length == 0) return 1;\n    return 0;\n  }\n  const renderProducts = () => {\n    if (products === null) return <CircularProgress />;\n    else if (products.error !== null && products.error !== undefined)\n      return <h1 style={{ color: 'red' }}>A loja não tem nenhum produto no momento</h1>;\n    else {\n      return products.map((product, index) => {\n        if (validateTags(product.tag)) {\n          if (name.length !== 0 && product.nome.includes(name))\n            return (\n              <div key={index}>\n                <Item\n                  productId={product._id}\n                  name={product.nome}\n                  image={product.imagem}\n                  description={product.descricao}\n                  price={product.preco}\n                  tag=''\n                  buttonConfig={{ icon: 'add', text: 'Adicionar aos favoritos', onClickFavorite }}\n                  onClick={id => onClickFavorite(id)}\n                />\n              </div>\n            );\n          else if (name.length === 0)\n            return (\n              <div key={index}>\n                <Item\n                  productId={product._id}\n                  name={product.nome}\n                  image={product.imagem}\n                  description={product.descricao}\n                  price={product.preco}\n                  tag=''\n                  buttonConfig={{ icon: 'add', text: 'Adicionar aos favoritos', onClickFavorite }}\n                  onClick={id => onClickFavorite(id)}\n                />\n              </div>\n            );\n        }\n      });\n    }\n  };\n  return (\n    <div style={{ display: 'flex', flexDirection: 'row', width: '100%', justifyContent: 'center' }}>\n      {renderProducts()}\n    </div>\n  );\n}\nListaProdutos.propTypes = {\n  filters: PropTypes.array.isRequired,\n  name: PropTypes.string.isRequired\n};\n\nexport default ListaProdutos;\n"]},"metadata":{},"sourceType":"module"}